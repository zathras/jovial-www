<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>

 
<!------------------------------->
<!--      ABOUT THIS HTML      -->
<!------------------------------->
<!-- FOLLOW THESE COMMENTS FOR -->
<!--   INFORMATION ABOUT THE   -->
<!-- STRUCTURE OF OUR TEMPLATES-->
<!------------------------------->
 
<!------------------------------->
<!--   INSERT YOUR TITLE HERE  -->
<!------------BEGIN-TITLE-------->
<HEAD>
<TITLE>
Applet Execution Environment
</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#990000" ALINK="#333399"
      VLINK="#333399">
<a name=top></a>
<!-- begin main page table -->
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0">
<TR>
<TD WIDTH="157" VALIGN="TOP">
 
<!------------------------------->
<!--  SERVER SIDE INCLUDE FOR  -->
<!--  NAVIGATION MENU AT LEFT  -->
<!------------------------------->
 

        <!-- Begin Navbar Segment -->

        <TABLE BORDER="0">
        <TR VALIGN=TOP>
           <TD WIDTH="155">
              <IMG SRC="http://java.sun.com/images/pixel.gif" HEIGHT="20" WIDTH="20" ALT="">

              <A HREF="/"><IMG SRC="http://java.sun.com/images/logos/javalogo52x88.gif" border="0" HEIGHT="88" WIDTH="52" ALT="Java Technology Home Page"></A><BR>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="157">

<!-- the following spacer ensures that the -->
<!--   table is at least 157 pixels wide   -->

<TR><TD></TD></TR>

<!-- tab categories -->

<TR><TD></TD>
<TD><A HREF="/products/">
<IMG SRC="http://java.sun.com/images/navbar/side.tab.products.gif" HEIGHT="15" WIDTH="130"
BORDER="0" ALT="Downloads, APIs, Documentation"></A></TD>
</TR>

<TR><TD></TD>
<TD><A HREF="/jdc/">
<IMG SRC="http://java.sun.com/images/navbar/side.tab.developer.gif" HEIGHT="15" WIDTH="130"
BORDER="0" ALT="Java Developer Connection"></A></TD>
</TR>

<TR><TD></TD>
<TD><A HREF="/infodocs/"><IMG SRC="http://java.sun.com/images/navbar/side.tab.docs.gif" HEIGHT="15" WIDTH="130"
BORDER="0" ALT="Docs, Tutorials, Tech Articles, Training"></A></TD>
</TR>

<TR><TD></TD>
<TD><A HREF="/support/"><IMG SRC="http://java.sun.com/images/navbar/side.tab.support.gif" HEIGHT="15" WIDTH="130"
BORDER="0" ALT="Online Support"></A></TD>
</TR>

<TR><TD></TD>
<TD><A HREF="/community/">
<IMG SRC="http://java.sun.com/images/navbar/side.tab.community.gif" HEIGHT="15" WIDTH="130" BORDER="0" ALT="Community Discussion"></A></TD>
</TR>

<TR><TD></TD>
<TD><A HREF="/industry">
<IMG SRC="http://java.sun.com/images/navbar/side.tab.news.gif" HEIGHT="15" WIDTH="130"
BORDER="0" ALT="News & Events from Everywhere"></A></TD>
</TR>

<TR><TD></TD>
<TD><A HREF="/solutions/">
<IMG SRC="http://java.sun.com/images/navbar/side.tab.solutions.gif" HEIGHT="15" WIDTH="130"
BORDER="0" ALT="Products from Everywhere"></A></TD>
</TR>

<TR><TD></TD>
<TD><A HREF="/casestudies/">
<IMG SRC="http://java.sun.com/images/navbar/side.tab.case.gif" HEIGHT="15" WIDTH="130"
BORDER="0" ALT="How Java Technology is Used Worldwide"></A></TD>
</TR>

<TR><TD></TD><TD></TD></TR>

</TABLE>
	   <P>
          </TD>
        </TR>
        </TABLE>

        <!-- End Navbar Segment -->


 
</TD>
<TD WIDTH="452" VALIGN="TOP">
<!--  begin header table -->
<TABLE BORDER="0" WIDTH="452">

<!------------------------------->
<!--  SERVER SIDE INCLUDE FOR  -->
<!--  HEADER AT TOP OF PAGE    -->
<!------------------------------->
 

          <!-- Begin Header Segment -->

          <TR>
            <TD>

<FORM method=GET action="http://search.java.sun.com/query.html">
<input type=hidden name=col value="jsun">
<input type=hidden name=pw value="100%">
<input type=hidden name=ws value="0">
<input type=hidden name=nh value="10">
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%">
<TR>
<TD ALIGN="RIGHT"><IMG SRC="http://java.sun.com/images/banners/stripelt.gif" WIDTH=6 HEIGHT=14 ALT=""></TD>
<TD WIDTH="100%">
  <TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%">
  <TR><TD BGCOLOR="#CC9966" WIDTH="100%"><IMG SRC="http://java.sun.com/images/pixel.gif" HEIGHT=2 WIDTH=1 ALT=""></TD></TR>
  <TR><TD><IMG SRC="http://java.sun.com/images/pixel.gif" HEIGHT=2 WIDTH=1 ALT=""></TD></TR>
  <TR><TD BGCOLOR="#CC9966"><IMG SRC="http://java.sun.com/images/pixel.gif" HEIGHT=2 WIDTH=1 ALT=""></TD></TR>
  <TR><TD><IMG SRC="http://java.sun.com/images/pixel.gif" HEIGHT=2 WIDTH=1 ALT=""></TD></TR>
  <TR><TD BGCOLOR="#CC9966"><IMG SRC="http://java.sun.com/images/pixel.gif" HEIGHT=2 WIDTH=1 ALT=""></TD></TR>
  <TR><TD><IMG SRC="http://java.sun.com/images/pixel.gif" HEIGHT=2 WIDTH=1 ALT=""></TD></TR>
  <TR><TD BGCOLOR="#CC9966"><IMG SRC="http://java.sun.com/images/pixel.gif" HEIGHT=2 WIDTH=1 ALT=""></TD></TR>
  </TABLE></TD>
<TD ALIGN="LEFT"><IMG SRC="http://java.sun.com/images/banners/stripert.gif" WIDTH=6 HEIGHT=14 ALT=""></TD>

<TD><TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0">
  <TR><TD VALIGN="CENTER"><A HREF="/a-z/"><IMG SRC="http://java.sun.com/images/banners/azindex.gif" WIDTH=72 HEIGHT=11 ALT="A-Z Index" BORDER="0"></A></TD>
  <TD VALIGN="CENTER"><FONT FACE="Helvetica" SIZE="1"><INPUT TYPE="text" SIZE="15" MAXLENGTH="2033" NAME=qt></FONT></TD>
  <TD VALIGN="CENTER"><INPUT TYPE="image" SRC="/images/banners/search.button.gif" value="search" name="search" WIDTH=55 HEIGHT=14 ALT="Search the Site" BORDER="0"></TD></TR></TABLE></TD>

</TR>

</TABLE></FORM><P>



<TABLE BORDER="0" WIDTH="100%" CELLPADDING="0" CELLSPACING="0">
<TR VALIGN="TOP">
<TD WIDTH="100%"><IMG SRC="http://java.sun.com/images/pixel.gif" HEIGHT=18 WIDTH=20></TD>
<TD ROWSPAN="3" ALIGN="RIGHT" WIDTH="152">
<A HREF="/"><IMG SRC="http://java.sun.com/images/banners/thesourceforjava.gif" WIDTH=389 HEIGHT=42 ALT="The Source for Java Technology" BORDER=0></A></TD></TR>
<TR VALIGN="TOP">
<TD BGCOLOR="#CC9966" HEIGHT="1" WIDTH="100%">
  <IMG SRC="http://java.sun.com/images/pixel.gif" HEIGHT=1 WIDTH=1></TD></TR>
<TR VALIGN="TOP">
<TD WIDTH="100%"><IMG SRC="http://java.sun.com/images/pixel.gif" WIDTH=20 HEIGHT=20></TD>
<TD ALIGN="RIGHT"></TD></TR>
</TABLE>


            </TD>
          </TR>

          <!-- End Header Segment -->

 
<!-- breadcrumb trail -->
</TABLE>
<TABLE BORDER=0 WIDTH=452>
   <TR>
      <TD ALIGN=RIGHT>
 
<!-- page headline -->
 
<!------------------------------->
<!--EDIT THE PAGE HEADLINE HERE-->
<!------------BEGIN-HEADLINE----->
<font size="+2">
HotJava<sup><font size=-2>TM</font></sup> Browser
</font>
<br>
<b>
Version 1.1
<br>
Inter-Applet Communication 
</b>
</TD>
</TR>
<TR>
 
<!-------------END-HEADLINE------>
<!--    END OF PAGE HEADLINE   -->
<!------------------------------->
 
<!-- subcategories of the current topic -->

<!------------------------------->
<!-- MAKE DUPLICATE LINKS HERE -->
<!--OF LINKS THAT OCCUR THROUGH-->
<!--  OUT THE BODY OF THIS DOC -->
<!------------BEGIN-SUB TOPICS--->
 
<!--
<TD ALIGN=RIGHT VALIGN=TOP HEIGHT=30>
</TD>
-->

</TR>
 
<!-------------END-SUB TOPICS---->
<!--    END OF SUBTOPICS       -->
<!------------------------------->
 
<TR>
<TD WIDTH=452>
 
<hr size="3" align=center noshade=noshade>
 
<!-- Begin Page Data -->
 
 
<!------------------------------->
<!--  EDIT PAGE CONTENT HERE   -->
<!------------BEGIN-CONTENT------>


<P>
The Java platform defines APIs for the execution of applets in web browsers.  While browsers and other execution environments may vary, users have discovered how popular browsers behave. While no specification guarantees it, developers have learned that applets can communicate with one another 
through static data members. 
<!--
 http://www.tientien.com/tjn/iac/index.html
-->
<P>
To reduce confusion and guesswork, this page describes how the HotJava Browser Browser 1.1 handles this problem. 
<P>
<b>Note:</B> This is not an official specification of the behavior of applet execution environments; other browsers may not exhibit exactly the same behavior.

<hr size="3" align=center noshade=noshade>


<H2>Applet Scope and Codebase</H2>

<P>
We define the sharing of static data members between applets in terms
of scope. For example, consider two applets, both of which refer to this class:
<PRE><font size=-1>
    public class StaticHolder {
	public String aStatic;
    }
</font>
</PRE>

Do two applets share a copy of StaticHolder.aStatic, or do they have different copies?
<P>
In the the HotJava Browser, an applet's scope is determined by the codebase--the directory that holds the root of the tree
where the .class files reside. The codebase is also the URL of the base of
the applet. 
So, if the two applets have a common codebase, then they share a copy of StaticHolder.aStatic. If they come from different codebases, though,
they each need a separate copy.


<P>An applet's codebase may refer either to the site from which the HTML document containing the &lt;APPLET&gt; tag was loaded or to a different site. 
If the codebase refers to a different site, then the applet's permissions  reflect those of the codebase.
The archive parameter (the preferred way of specifying one or more .jar files) does not affect the codebase. 
<P>

<P>We use this algorithm to determine an applet's codebase:
<PRE><font size=-1>
    docbase := URL of document containing applet tag, 
	       less file name part
    if (applet has a codebase parameter) then
	value := the value of the codebase parameter;
	if value ends in ".jar", strip it off;
	codebase := new URL(docbase, value)
    else
	codebase := docbase
    fi
</font>
</PRE>


The state visible to an applet consists of:
<ul>
<li>all the state it can reach through methods of java.lang.Applet
<p>plus 
<P>
<li>the static state of any classes it can access, subject to the Java language's access specifiers
</ul>
<P>
This means that an applet can access static data members of other applets, whether on the same browser page or not, provided that the two applets have the same codebase.
<P>
Applets on the same page may use the methods AppletContext.getApplet(String) and AppletContext.getApplets() to communicate with one another. These methods give references only 
to applets in the same document with the same codebase as the calling applet.
<P>
For the purposes of AppletContext.getApplets(), a document is tied to a single source file. Thus, a document containing a &lt;FRAMESET&gt; is one
document, and each frame within the &lt;FRAMESET&gt; is a seperate document. 
If you want to allow applets in different frames to access each other via getApplets(), however, set the system property hotjava.security.getInterFrameApplets to true.

<H3>Static Members of CLASSPATH Classes</H3>

<P>
Subject to normal security constraints, an applet may refer to static data members of classes that appear on the CLASSPATH, for which there is exactly one copy of static state system-wide.

<H2>Applet Lifetime</H2>
<P>
An applet is considered alive from the time its constructor is run until it receives Applet.destroy(). 
<P>
The HotJava Browser may destroy an applet that is not on a visible page at any time. It tries not to destroy applets that are on visible pages, but it may need to do so 
under certain circumstances, such as very low memory. 
<P>
For instance, if you visit page P and then navigate to another page, the HotJava Browser may or may not destroy applets on page P. If you revisit page P (as with the Back button), and the applets are still alive, they simply receive an Applet.start() call. If the HotJava Browser has had to destroy 
the applets, it creates new ones. 
<P>

<H3>Applet Thread Lifetime</H3>
<P>
To be considered well-behaved, an applet must clean up any resources for which it is responsible when the method Applet.destroy() is invoked.
Since threads are part of the state associated with a codebase, the applet's
clean-up should include stopping any threads it has created. 
If an applet fails to clean up threads after receiving the destroy() notification, the browser may reap applet threads forcibly with a mechanism such as Thread.interrupt().

<P>
Cooperating applets may share a thread, for instance, if the first applet in a codebase spawns a daemon thread to do some useful work, and then several applets on different pages use that thread. In a well-behaved scenario, the last applet in a codebase makes sure that that thread terminates when the applet receives its destroy() notification. 
<P>

If a group of applets fails to terminate a thread, the browser will terminate it forcibly.  
However, the browser will not terminate a thread when one or more applets might depend on 
it. The browser will terminate an applet thread only when there are no active applets in the 
codebase from which the thread was created.

<P>
Our policy with respect to threads is:
<ul>
<LI>
Threads are identified with the codebase of the code responsible for their creation. 
<P>
<LI>
Threads shall not be forcibly terminated until after the last applet in a given codebase has received its destroy() notification. 
<P>
<LI>
Once threads are forcibly terminated, all static state associated with the given codebase will be flushed. If an applet from that codebase is encountered later, it will have all of its static state freshly initialized as though that codebase had never been encountered before.
</ul>

<h3>Applets and Page Reload</h3>
<P>
When the HotJava Browser reloads a page, it usually roloads any applets on the page; it destroys the old applets and creates new applets with fresh static state.
<P>
However, when two browser windows are visible and both contain applets from the same codebase, the HotJava Browser must either flush both windows or flush 
neither of them if it is to  maintain the same static state for applets in both windows. 
In version 1.1, we chose to reload neither; that is, when the HotJava Browser 
reloads a page, it reloads the applets only if no other applets from the same codebase are visible.



<H2>Summary</H2>
<P>
The rules outlined above are driven by two architectural principles: 

<ul>
<li>
An applet's codebase determines its scope.
<P>
<li>
Applet scope implies lifetime.
</ul>
<P>
In other words, the codebase controls the set of static state that an applet may access. 
If applets can share state, they can also share threads. For this 
reason, the browser terminates applet threads only when their codebase is not being used.

<p>
</TD>
</TR>
</TABLE>
 
</TD>
</TR>
</TABLE>

<!-- Footer table -->
<!------------------------------->
<!--  SERVER SIDE INCLUDE FOR  -->
<!--  FOOTER AT BOTTOM OF PAGE -->
<!------------------------------->
 
<!-- Begin Footer Segment -->

<BR CLEAR="ALL">

<TABLE WIDTH="100%" CELLPADDING="0" BORDER="0" CELLSPACING="5">   
<TR>
	<TD VALIGN="TOP">
	<P ALIGN=CENTER>
	<FONT SIZE="-1" COLOR="#999999">[ This page was updated: 26-Sep-98 ]</font></P>
	</TD>
</TR>
<TR>
	<TD BGCOLOR="#CCCCCC">
	<SPACER TYPE="BLOCK" HEIGHT="1" WIDTH="1"></TD>
</TR>
<TR>
	<TD>
	<CENTER>
	<FONT SIZE="-1">
	<A HREF="/products/">Products &amp; APIs</A> | 
	<A HREF="/jdc/">Developer Connection</A> | 
	<A HREF="/infodocs/">Docs &amp; Training</A> | 
	<A HREF="/support/">Support</A><BR>
	<A HREF="/community/">Community Discussion</A> |
	<A HREF="/industry/">Industry News</A> | 
	<A HREF="/solutions/">Solutions Marketplace</A> | 
	<A HREF="/casestudies/">Case Studies</A>
	</FONT>
	</CENTER>
	</TD>
</TR>
<TR>
	<TD BGCOLOR="#CCCCCC">
	<SPACER TYPE="BLOCK" HEIGHT="1" WIDTH="1"></TD>
</TR>
<TR>
	<TD ALIGN="CENTER">
	<FONT SIZE="-2">
	<A HREF="/docs/glossary.html">Glossary</A> - 
	<A HREF="/applets/">Applets</A> - 
	<A HREF="/docs/books/tutorial/">Tutorial</A> - 
	<A HREF="/jobs/">Employment</A> - 
	<A HREF="/nav/business/">Business &amp; Licensing</A> - 
	<A HREF="/javastore/">Java Store</A> -
	<A HREF="/casestudies/">Java in the Real World</A>
	</FONT>
	</TD>
</TR>

<TR>
	<TD>
	<CENTER>
	<FONT SIZE="-2">
	<a href="/cgi-bin/feedback.pl">Feedback</a> | 
	<a href="http://www.dynamicdiagrams.net/mapa/cgi-bin/help.tcl?db=javasoft&dest=http://java.sun.com/">Map</a> | 
	<A HREF="/a-z/index.html">A-Z Index</A>
	</FONT>
	</CENTER>
	<P>
	</TD>
</TR>
<TR>
	<TD>
		<TABLE WIDTH="100%" CELLPADDING="0" BORDER="0" CELLSPACING="0">
		<TR>
		<TD WIDTH="50%">
		<FONT SIZE="-2">
		For more information on Java technology<BR>
		and other software from Sun Microsystems, call:<BR>
		</FONT>
		<FONT SIZE="-1">
		(800) 786-7638<BR></FONT>
		<FONT SIZE="-2">
		Outside the U.S. and Canada, dial your country's <A HREF="http://www.att.com/business_traveler/attdirecttollfree/">AT&amp;T&nbsp;Direct&nbsp;Access&nbsp;Number</A> first.<BR>
		</FONT>
		</TD>
		<TD ALIGN="RIGHT" WIDTH="50%">
		<A HREF="http://www.sun.com">
		<IMG SRC="http://java.sun.com/images/buttons/lgsun.gif" width="64"
		height="30" border="0" ALT="Sun Microsystems, Inc."></A><BR>
		<FONT SIZE="-2">
		Copyright &copy; 1995-99
		<A HREF="http://www.sun.com">Sun Microsystems, Inc.</A><BR>
		All Rights Reserved. <a href="http://www.sun.com/share/text/SMICopyright.html">Legal Terms</a>. <A HREF="http://www.sun.com/privacy">Privacy&nbsp;Policy</A>.
		</FONT>
		</TD></TR></TABLE>

	</TD>
</TR> 
</TABLE>

<!-- End Footer Segment -->

 
</BODY>
</HTML>

